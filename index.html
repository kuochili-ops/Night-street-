<script>
/**
 * [FlipBoardModule] æ…£æ€§è»Ÿè‘—é™¸ç‰ˆ
 * è§£æ±º 4.1s ç¡¬åœæ­¢ç”¢ç”Ÿçš„å½ˆè·³æ„Ÿã€‚
 */
const FlipBoardModule = (() => {
    return {
        getY: (h, time, speedFactor, endTime, yOffset) => {
            const startTime = 0.8;
            const startY = h * -0.2 + parseFloat(yOffset); 
            const speed = h * speedFactor;

            if (time < startTime) return startY;

            // ğŸš© æ ¸å¿ƒé‚è¼¯ï¼šåœ¨ endTime ä¹‹å‰æ­£å¸¸ç·šæ€§ç§»å‹•
            if (time <= endTime) {
                return startY + (speed * (time - startTime));
            } else {
                // ğŸš© è»Ÿè‘—é™¸éšæ®µï¼šä½¿ç”¨æŒ‡æ•¸è¡°æ¸›å‡½æ•¸ (Damping)
                // è®“æ–‡å­—åœ¨ endTime å¾Œç¹¼çºŒæ»‘è¡Œæ¥µå°çš„ä¸€æ®µè·é›¢ï¼Œä¸¦åœ¨ 0.2 ç§’å…§å®Œå…¨åœæ­»
                const yAtEnd = startY + (speed * (endTime - startTime));
                const deltaTime = time - endTime;
                
                // è¡°æ¸›ä¿‚æ•¸ 15 ä»£è¡¨æ¥µå¿«åœä¸‹ï¼Œæ—¢ä¿ç•™äº†æ…£æ€§åˆä¸æœƒæœ‰ä¸‹å¢œè¦–è¦º
                const dampingEffect = (speed / 15) * (1 - Math.exp(-15 * deltaTime));
                
                return yAtEnd + dampingEffect;
            }
        }
    };
})();

// ä¿®æ”¹ render å‡½æ•¸ä¸­çš„åº§æ¨™è™•ç†ï¼Œå¾ Math.round æ”¹ç‚ºæ›´å¹³æ»‘çš„æ•¸å€¼
function render() {
    // ... å‰æ®µä»£ç¢¼ä¸è®Š ...
    if (time >= 0.8) {
        ctx.save();
        // ğŸš© ç§»é™¤ Math.roundï¼Œæ”¹ç”¨æ™®é€šæ•¸å€¼è®“ç€è¦½å™¨åŸ·è¡ŒæŠ—é‹¸é½’æ¸²æŸ“ï¼Œæ¸›å°‘é–ƒçˆ
        const currentY = FlipBoardModule.getY(h, time, speed, end, offset);
        
        // ... ç¹ªè£½é‚è¼¯ ...
    }
}
</script>
